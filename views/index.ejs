<div class="panel" data-ranking-provider="dlsite-blogparts">
  <div class="panel-body">
    <script type="text/javascript">blogparts={"base":"https://www.dlsite.com/","type":"ranking","site":"maniax","query":{"period":"week"},"title":"ランキング","display":"horizontal","detail":"1","column":"v","image":"large","count":"3","wrapper":"1","autorotate":true,"aid":"ruruGamesJP"}</script>
    <script type="text/javascript" src="https://www.dlsite.com/js/blogparts.js" charset="UTF-8"></script>
  </div>
</div>

<section class="articles-section page-section">
  <div class="page-header">
    <h2 class="section-title">最新記事</h2>
    <p class="section-lead">レビュー・記事をパネル形式で一覧表示します。気になる記事をクリックして詳細を確認してください。</p>
  </div>

  <div class="panel">
    <div class="panel-body">
      <div class="articles-grid">
        <% if (articles.length > 0) { %>
          <% articles.forEach(article => { %>
            <article class="article-card">
              <% if (article.imageUrl) { %>
                <div class="article-image">
                  <img src="<%= article.imageUrl %>" alt="<%= article.gameTitle %>">
                </div>
              <% } %>
              <div class="article-content">
                <div class="article-meta">
                  <span class="genre"><%= article.genre || 'ゲーム' %></span>
                  <% if (article.rating) { %>
                    <span class="rating"><%= '★'.repeat(article.rating) + '☆'.repeat(10 - article.rating) %></span>
                  <% } %>
                </div>
                <h2><%= article.title %></h2>
                <h3 class="game-title"><%= article.gameTitle %></h3>
                <p class="description"><%= article.description.substring(0, 150) %>...</p>
                <% if (article.tags && article.tags.length > 0) { %>
                  <div class="article-tags">
                    <% article.tags.slice(0, 3).forEach(tag => { %>
                      <span class="tag-small">#<%= tag %></span>
                    <% }); %>
                  </div>
                <% } %>
                <div class="article-footer">
                  <div class="author-info">
                    <img src="<%= article.author.image %>" alt="<%= article.author.email === 'hiderance1919@gmail.com' ? '管理者' : article.author.displayName %>" class="author-avatar">
                    <span><%= article.author.email === 'hiderance1919@gmail.com' ? '管理者' : article.author.displayName %></span>
                  </div>
                  <span class="date"><%= new Date(article.createdAt).toLocaleDateString('ja-JP') %></span>
                </div>
                <a href="/articles/<%= article._id %>" class="btn-read-more">続きを読む</a>
              </div>
            </article>
          <% }); %>
        <% } else { %>
          <div class="no-articles">
            <p>まだ記事がありません。</p>
            <% if (user) { %>
              <a href="/articles/new" class="btn-primary">最初の記事を作成する</a>
            <% } else { %>
              <a href="/auth/google" class="btn-primary">ログインして記事を作成</a>
            <% } %>
          </div>
        <% } %>
      </div>
    </div>
  </div>
</section>

<!-- content wrapper is provided by layout.ejs -->
